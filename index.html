<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>è³¼å±‹èƒ½åŠ›è©¦ç®— | å°ˆå±¬æœå‹™</title>
  <style>
    :root{
      /* === è‰²å½©è¨ˆç•«ï¼šä¹¾ç‡¥ç«ç‘°èˆ‡æº«æš–ç° === */
      --primary: #c05c7e;       /* ä¸»è‰²ï¼šä¹¾ç‡¥ç«ç‘°ç´… (å°ˆæ¥­ä¸”å„ªé›…) */
      --primary-light: #fdf2f6; /* æ·ºè‰²ï¼šæ¥µæ·ºç²‰ç´…èƒŒæ™¯ */
      --primary-hover: #b04b6d; /* æ·±è‰²ï¼šæŒ‰éˆ•æ‡¸åœ */
      --accent: #d68c9f;        /* è£é£¾è‰² */
      --text: #4a4a4a;          /* æ–‡å­—ï¼šæ·±æš–ç° (æ¯”ç´”é»‘æŸ”å’Œ) */
      --text-light: #787878;    /* æ¬¡è¦æ–‡å­— */
      --bg-gradient: linear-gradient(135deg, #fff6f8 0%, #fff 100%);
      --card-shadow: 0 10px 40px rgba(192, 92, 126, 0.1);
      --radius: 20px;           /* æ›´å¤§çš„åœ“è§’ */
    }

    * { box-sizing: border-box; }
    
    body {
      font-family: 'Helvetica Neue', Helvetica, 'PingFang TC', 'Microsoft JhengHei', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--bg-gradient);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .wrap {
      width: 100%;
      max-width: 500px;
      background: #fff;
      padding: 30px 24px;
      border-radius: var(--radius);
      box-shadow: var(--card-shadow);
      border: 1px solid #fff;
    }

    h2 {
      text-align: center;
      color: var(--primary);
      margin: 0 0 24px;
      font-weight: 600;
      letter-spacing: 1px;
    }

    /* è¼¸å…¥æ¡†æ¨™ç±¤ */
    label {
      display: block;
      font-weight: 500;
      margin-top: 16px;
      font-size: 14px;
      color: var(--text);
    }

    /* è¼¸å…¥æ¡†æ¨£å¼ */
    input[type=number] {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      margin-top: 8px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: #fcfcfc;
      color: var(--text);
    }
    
    input[type=number]:focus {
      outline: none;
      border-color: var(--accent);
      background: #fff;
      box-shadow: 0 0 0 3px rgba(214, 140, 159, 0.2);
    }

    /* æŒ‰éˆ•ç¾¤çµ„ */
    .btnGroup {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .optBtn {
      flex: 1;
      min-width: 60px;
      padding: 10px 0;
      border-radius: 50px; /* å…¨åœ“è§’ */
      border: 1px solid #ecdce4;
      background: #fff;
      cursor: pointer;
      color: var(--text-light);
      font-size: 14px;
      transition: all 0.2s;
    }

    .optBtn:hover {
      background: #fff0f5;
    }

    .optBtn.selected {
      background: var(--primary);
      border-color: var(--primary);
      color: #fff;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(192, 92, 126, 0.3);
    }

    .muted {
      color: var(--text-light);
      font-size: 13px;
      margin-top: 16px;
      line-height: 1.5;
      background: #f9f9f9;
      padding: 12px;
      border-radius: 12px;
    }

    /* çµæœå€å¡Š */
    .result {
      margin-top: 24px;
      padding: 20px;
      border-radius: 16px;
      background: var(--primary-light);
      border: 1px solid #fceef2;
      display: none;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .result p {
      margin: 8px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 15px;
      border-bottom: 1px dashed #e8d0d8;
      padding-bottom: 8px;
    }
    
    .result p:last-child { border-bottom: none; }

    /* çµæœä¸­çš„é‡é»æ•¸å­— */
    .result strong {
      color: var(--primary);
      font-size: 20px;
      font-weight: 700;
    }

    .hint {
      color: #e11d48;
      font-size: 13px;
      margin-top: 8px;
      text-align: center;
    }

    /* === é å°¾åç‰‡å€ === */
    footer {
      margin-top: 40px;
      padding-top: 24px;
      text-align: center;
      position: relative;
    }
    
    footer::before {
      content: "";
      display: block;
      width: 40px;
      height: 3px;
      background: #fce7f3;
      margin: 0 auto 20px;
      border-radius: 2px;
    }

    .agent-title {
      font-size: 12px;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 1.5px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .agent-name {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 8px;
    }

    .store-info {
      font-size: 13px;
      color: var(--text-light);
      margin-bottom: 4px;
    }

    /* LINE æŒ‰éˆ•å„ªåŒ– */
    .contact-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
      padding: 12px 28px;
      background-color: #06c755; 
      color: white;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      font-size: 15px;
      box-shadow: 0 4px 15px rgba(6, 199, 85, 0.25);
      transition: all 0.2s;
    }

    .contact-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(6, 199, 85, 0.35);
      background-color: #05b54d;
    }

    .copyright {
      margin-top: 30px; 
      font-size: 11px; 
      color: #ccc;
    }

    @media (max-width: 480px) {
      body { padding: 10px; }
      .wrap { padding: 24px 20px; }
      .result strong { font-size: 18px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <input id="ltvVal" type="hidden" value="80">
    <input id="yearsVal" type="hidden" value="30">

    <h2>è³¼å±‹èƒ½åŠ›è©¦ç®—</h2>

    <label>ç›®å‰æœˆè–ªï¼ˆå¯¦é ˜ï¼Œå…ƒï¼‰</label>
    <input id="salary" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ï¼š45000">

    <label>æ¯æœˆè²¸æ¬¾æ”¯å‡ºï¼ˆè»Šè²¸ / ä¿¡è²¸ï¼Œå…ƒï¼‰</label>
    <input id="debt" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ï¼š8000" value="0">

    <label>æˆ¿è²¸å¹´åˆ©ç‡ï¼ˆå¹´ %ï¼‰</label>
    <input id="rate" type="number" step="0.01" inputmode="decimal" placeholder="ä¾‹å¦‚ï¼š2.25" value="2.25">

    <label>è²¸æ¬¾æˆæ•¸</label>
    <div id="ltvButtons" class="btnGroup">
      <button type="button" class="optBtn" data-val="60">60%</button>
      <button type="button" class="optBtn" data-val="70">70%</button>
      <button type="button" class="optBtn" data-val="75">75%</button>
      <button type="button" class="optBtn" data-val="80">80%</button>
    </div>

    <label>è²¸æ¬¾å¹´é™</label>
    <div id="yearButtons" class="btnGroup">
      <button type="button" class="optBtn" data-val="20">20 å¹´</button>
      <button type="button" class="optBtn" data-val="30">30 å¹´</button>
      <button type="button" class="optBtn" data-val="40">40 å¹´</button>
    </div>

    <div class="muted">
      ğŸ’¡ éŠ€è¡Œå»ºè­°æœˆç¹³ä¸Šé™ï¼š<br><strong>ï¼ˆæœˆè–ª - ç¾æœ‰æ¯æœˆè² å‚µï¼‰Ã— 60%</strong>ã€‚<br>è©¦ç®—çµæœåŒ…å«ç´„ 2% ä»²ä»‹æœå‹™è²»ã€‚
    </div>

    <div id="result" class="result" role="region" aria-live="polite">
      <p>å»ºè­°æˆ¿å±‹ç¸½åƒ¹ <span id="housePrice"></span></p>
      <p>å»ºè­°è‡ªå‚™æ¬¾ <span id="downpayment"></span></p>
      <p>éŠ€è¡Œå¯è²¸é‡‘é¡ <span id="loanAmount"></span></p>
      <p>éŠ€è¡Œå»ºè­°æœˆç¹³ <span id="suggestedMonthly"></span></p>
      <p>æ­¤æˆ¿åƒ¹å¯¦éš›æœˆç¹³ <span id="actualMonthly"></span></p>
      <p>ä»²ä»‹æœå‹™è²» (2%) <span id="fee"></span></p>
    </div>

    <p id="needFill" class="hint" style="display:none">è«‹å¡«å¯«ã€Œç›®å‰æœˆè–ªã€èˆ‡ã€Œæˆ¿è²¸å¹´åˆ©ç‡ã€æ‰èƒ½é¡¯ç¤ºè©¦ç®—çµæœã€‚</p>

    <footer>
      <div class="agent-title">Professional Realtor</div>
      <div class="agent-name">ä½å•†ä¸å‹•ç”¢ãƒ»å¼µå–»æš„</div>
      <div class="store-info">æ°¸åº·å¾©åœ‹åº—</div>
      <div class="store-info">å°å—å¸‚æ°¸åº·å€å¾©åœ‹è·¯89è™Ÿ</div>
      
      <a class="contact-btn" href="https://line.me/ti/p/kVH_xqPK_F" target="_blank">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="margin-right:8px"><path d="M22 10.3c0-4.6-4.5-8.3-10-8.3S2 5.7 2 10.3c0 4.1 3.6 7.5 8.9 8.2.3 0 .8.2.9.5l.6 2c.2.5.1.9-.3.7L15 19.5c2.7-.8 5.7-3.8 5.7-7.2h1.3z"/></svg>
        é ç´„è«®è©¢ / åŠ  LINE å¥½å‹
      </a>
      <div class="copyright">Â© 2025 H&B. All Rights Reserved.</div>
    </footer>
  </div>

  <script>
    // æ•¸å­—æ ¼å¼åŒ–ï¼šå››æ¨äº”å…¥åˆ°è¬
    const fmtWan = n => {
        const wan = Math.round(n/10000);
        return `<strong>${wan.toLocaleString()} è¬</strong>`;
    };
    // æ•¸å­—æ ¼å¼åŒ–ï¼šåƒ…åŠ åƒåˆ†ä½ (çµ¦æœˆç¹³ç”¨)
    const fmtInt = n => `<strong>${Math.round(n).toLocaleString()} å…ƒ</strong>`;

    const salaryEl = document.getElementById('salary');
    const debtEl = document.getElementById('debt');
    const rateEl = document.getElementById('rate');
    const ltvHidden = document.getElementById('ltvVal');
    const yearsHidden = document.getElementById('yearsVal');
    const resultEl = document.getElementById('result');
    const needFillEl = document.getElementById('needFill');

    function initButtons(containerId, hiddenEl, defaultVal) {
      const container = document.getElementById(containerId);
      container.querySelectorAll('.optBtn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          container.querySelectorAll('.optBtn').forEach(b=>b.classList.remove('selected'));
          btn.classList.add('selected');
          hiddenEl.value = btn.dataset.val;
          autoCalc();
        });
      });
      const defaultBtn = container.querySelector('.optBtn[data-val="'+defaultVal+'"]');
      if(defaultBtn) defaultBtn.classList.add('selected');
      hiddenEl.value = defaultVal;
    }

    function autoCalc(){
      const salary = Number(salaryEl.value) || 0;
      const debt = Number(debtEl.value) || 0;
      const annualRate = Number(rateEl.value);
      const currentLtv = Number(ltvHidden.value)/100; // ä½¿ç”¨è€…é¸æ“‡çš„æˆæ•¸
      const years = Number(yearsHidden.value);

      if(!salary || annualRate===null||isNaN(annualRate)){
        resultEl.style.display='none';
        needFillEl.style.display='block';
        return;
      } else { 
        needFillEl.style.display='none'; 
      }

      // 1. è¨ˆç®—åŸºæœ¬æœˆä»˜èƒ½åŠ› (è² å‚µæ¯” 60%)
      const maxDTI = 0.6;
      let available = (salary * maxDTI) - debt;
      if (available < 0) available = 0;
      const suggestedMonthly = Math.round(available);

      // 2. æº–å‚™è²¸æ¬¾åƒæ•¸
      const monthlyRate = annualRate / 100 / 12;
      const totalMonths = years * 12;
      
      if (totalMonths === 0) return;

      // 3. å…ˆè¨ˆç®—ã€Œçµ•å°æœ€å¤§è²¸æ¬¾èƒ½åŠ›ã€(åŸºæ–¼ 80% æˆæ•¸çš„æ¨™æº–æƒ…æ³)
      let baseMaxLoan;
      if (monthlyRate === 0) {
        baseMaxLoan = available * totalMonths;
      } else {
        baseMaxLoan = available * ((1 - Math.pow(1 + monthlyRate, -totalMonths)) / monthlyRate);
      }
      
      // 4. æ¨ç®—åŸºæº–æœ€å¤§ç¸½åƒ¹ (å‡è¨­ä»¥ 80% è²¸æ¬¾ç‚ºåŸºæº–èƒ½åŠ›)
      let baseMaxPrice = baseMaxLoan / 0.8;

      // 5. æ ¹æ“šä½¿ç”¨è€…é¸æ“‡çš„è²¸æ¬¾æˆæ•¸ï¼Œå›æ¨ç¾åœ¨çš„æˆ¿å±‹ç¸½åƒ¹å’Œè²¸æ¬¾é‡‘é¡
      // ç¸½åƒ¹ = åŸºæº–æœ€å¤§ç¸½åƒ¹ (å›ºå®šèƒ½åŠ›)
      const housePrice = baseMaxPrice;
      
      // è²¸æ¬¾é‡‘é¡ = ç¸½åƒ¹ Ã— ä½¿ç”¨è€…é¸æ“‡çš„æˆæ•¸
      const loanAmount = housePrice * currentLtv;
      
      // 6. è¨ˆç®—é ­æœŸæ¬¾
      const downpayment = housePrice - loanAmount;
      
      // 7. è¨ˆç®—å¯¦éš›æœˆç¹³ (åŸºæ–¼å¯¦éš›è²¸æ¬¾é‡‘é¡)
      let actualMonthly;
      if (monthlyRate === 0) {
        actualMonthly = loanAmount / totalMonths;
      } else {
        const factor = Math.pow(1 + monthlyRate, totalMonths);
        actualMonthly = loanAmount * monthlyRate * factor / (factor - 1);
      }
      
      // 8. è¨ˆç®—ä»²ä»‹è²»
      const fee = housePrice * 0.02;

      // æ›´æ–°ä»‹é¢
      document.getElementById('housePrice').innerHTML = fmtWan(housePrice);
      document.getElementById('downpayment').innerHTML = fmtWan(downpayment);
      document.getElementById('loanAmount').innerHTML = fmtWan(loanAmount);
      document.getElementById('suggestedMonthly').innerHTML = fmtInt(suggestedMonthly);
      document.getElementById('actualMonthly').innerHTML = fmtInt(actualMonthly);
      document.getElementById('fee').innerHTML = fmtWan(fee);

      resultEl.style.display='block';
    }

    initButtons('ltvButtons',ltvHidden,'80');
    initButtons('yearButtons',yearsHidden,'30');
    [salaryEl,debtEl,rateEl].forEach(el=>el.addEventListener('input',()=>autoCalc()));
    
    // é é¢è¼‰å…¥å¾Œè‹¥æœ‰é å¡«å€¼å‰‡è¨ˆç®—
    window.addEventListener('load',()=>{ autoCalc(); });
  </script>
</body>
</html>